// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.17/esri/copyright.txt for details.
//>>built
define("esri/tasks/NARouteSharing","dojo/_base/declare dojo/json dojo/Deferred dojo/_base/lang dojo/i18n!../nls/jsapi dojo/number ../request ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../arcgis/Portal ../tasks/RouteParameters ../tasks/RouteResult ../SpatialReference ../tasks/FeatureSet ../tasks/GeometryService ../tasks/ProjectParameters".split(" "),function(G,u,h,k,m,H,v,w,I,q,D,E,J,K,L,F,M,
N,O){return G(null,{declaredClass:"esri.tasks.NARouteSharing",portal:null,firstStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IGlkPSJzdmdfMyIgc3ByZWFkTWV0aG9kPSJwYWQiIGN4PSIwLjM4MTUzIiBjeT0iMC4yOTY4OCIgcj0iMC41Ij48c3RvcCBzdG9wLWNvbG9yPSIjNmJjMjc4IiBzdG9wLW9wYWNpdHk9IjAuOTg4MjgxIiBvZmZzZXQ9IjAiLz48c3RvcCBzdG9wLWNvbG9yPSIjMmU5ZjNkIiBzdG9wLW9wYWNpdHk9IjAuOTkyMTg4IiBvZmZzZXQ9IjEiLz48L3JhZGlhbEdyYWRpZW50PjwvZGVmcz48Zz48ZyBzdHJva2U9Im51bGwiIGlkPSJzdmdfMSI+PHBhdGggc3Ryb2tlPSIjMWM1ZTI0IiBzdHJva2Utb3BhY2l0eT0iMC43IiBmaWxsPSJ1cmwoI3N2Z18zKSIgc3Ryb2tlLWxpbmVqb2luPSJudWxsIiBzdHJva2UtbGluZWNhcD0ibnVsbCIgZD0ibTAuNTYyMTIsMTAuNjM0NTIxYzAsLTUuNTY0OSA0LjQ1NjcxMSwtMTAuMDcyNDYgOS45NTg4MjgsLTEwLjA3MjQ2YzUuNTAyMTA2LDAgOS45NTg4MjgsNC41MDc1NyA5Ljk1ODgyOCwxMC4wNzI0NmMwLDIuNzgyNDUgLTEuMTE0MTgsNS4zMDA1NyAtMi45MTYxMTYsNy4xMjMwNzNjLTAuOTAwOTY4LDAuOTExMjQ2IC0yLjk0MDQwOCwyLjI2NjE2MSAtNC43NDEzNDgsNC43MTI0NWMtMS44MDA5MjksMi40NDYyODkgLTIuMTkxMDQzLDYuMDM2ODc1IC0yLjI0NTYxNSw2LjAzNDUxNWMtMC4wNTQ1NjIsLTAuMDAyMzYgLTAuOTg1NzY3LC0zLjc3MjU1NCAtMi41OTczMzEsLTYuMTkzMzY1Yy0xLjYxMTU4NCwtMi40MjA4MSAtMy42MDAxNDEsLTMuNjQyMzU0IC00LjUwMTEwOSwtNC41NTM2Yy0xLjgwMTk0NiwtMS44MjI1MDIgLTIuOTE2MTE2LC00LjM0MDYyMyAtMi45MTYxMTYsLTcuMTIzMDczbDAsMGwtMC4wMDAwMjEsMHoiIGlkPSJzdmdfMiIvPjwvZz48ZWxsaXBzZSByeT0iNCIgcng9IjQiIGlkPSJzdmdfODciIGN5PSIxMC4zNDM3NSIgY3g9IjEwLjUiIHN0cm9rZS1vcGFjaXR5PSJudWxsIiBzdHJva2Utd2lkdGg9Im51bGwiIHN0cm9rZT0iIzFjNWUyNCIgZmlsbD0iI2ZmZmZmZiIvPjwvZz48L3N2Zz4\x3d",
contentType:"image/svg+xml"},interimStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogPGRlZnM+DQogIDxyYWRpYWxHcmFkaWVudCBpZD0ic3ZnXzMiIHNwcmVhZE1ldGhvZD0icGFkIiBjeD0iMC4zODE1MyIgY3k9IjAuMjk2ODgiIHI9IjAuNSI+DQogICA8c3RvcCBzdG9wLWNvbG9yPSIjNjdBN0U0IiBzdG9wLW9wYWNpdHk9IjAuOTg4MjgxIiBvZmZzZXQ9IjAiLz4NCiAgIDxzdG9wIHN0b3AtY29sb3I9IiMxQjgxRDIiIHN0b3Atb3BhY2l0eT0iMC45OTIxODgiIG9mZnNldD0iMSIvPg0KICA8L3JhZGlhbEdyYWRpZW50Pg0KIDwvZGVmcz4NCiA8Zz4NCiAgPHRpdGxlPjE8L3RpdGxlPg0KICA8ZyBzdHJva2U9Im51bGwiIGlkPSJzdmdfMSI+DQogICA8cGF0aCBzdHJva2U9IiMxYzVlMjQiIHN0cm9rZS1vcGFjaXR5PSIwLjciIGZpbGw9InVybCgjc3ZnXzMpIiBzdHJva2UtbGluZWpvaW49Im51bGwiIHN0cm9rZS1saW5lY2FwPSJudWxsIiBkPSJtMC41NjIxMiwxMC42MzQ1MjFjMCwtNS41NjQ5IDQuNDU2NzExLC0xMC4wNzI0NiA5Ljk1ODgyOCwtMTAuMDcyNDZjNS41MDIxMDYsMCA5Ljk1ODgyOCw0LjUwNzU3IDkuOTU4ODI4LDEwLjA3MjQ2YzAsMi43ODI0NSAtMS4xMTQxOCw1LjMwMDU3IC0yLjkxNjExNiw3LjEyMzA3M2MtMC45MDA5NjgsMC45MTEyNDYgLTIuOTQwNDA4LDIuMjY2MTYxIC00Ljc0MTM0OCw0LjcxMjQ1Yy0xLjgwMDkyOSwyLjQ0NjI4OSAtMi4xOTEwNDMsNi4wMzY4NzUgLTIuMjQ1NjE1LDYuMDM0NTE1Yy0wLjA1NDU2MiwtMC4wMDIzNiAtMC45ODU3NjcsLTMuNzcyNTU0IC0yLjU5NzMzMSwtNi4xOTMzNjVjLTEuNjExNTg0LC0yLjQyMDgxIC0zLjYwMDE0MSwtMy42NDIzNTQgLTQuNTAxMTA5LC00LjU1MzZjLTEuODAxOTQ2LC0xLjgyMjUwMiAtMi45MTYxMTYsLTQuMzQwNjIzIC0yLjkxNjExNiwtNy4xMjMwNzNsMCwwbC0wLjAwMDAyMSwweiIgaWQ9InN2Z18yIi8+DQogIDwvZz4NCiA8L2c+DQo8L3N2Zz4NCg\x3d\x3d",
contentType:"image/svg+xml"},lastStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IHI9IjAuNSIgY3k9IjAuMzU1NDciIGN4PSIwLjMzMjAzIiBzcHJlYWRNZXRob2Q9InBhZCIgaWQ9InN2Z182Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3Atb3BhY2l0eT0iMC45OTYwOSIgc3RvcC1jb2xvcj0iI2U0ODY2NyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIwLjk5NjA5IiBzdG9wLWNvbG9yPSIjYzkzYTE2Ii8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PGc+PGcgc3Ryb2tlPSJudWxsIiBpZD0ic3ZnXzEiPjxwYXRoIHN0cm9rZT0iIzg0MjMwYSIgc3Ryb2tlLW9wYWNpdHk9IjAuNyIgZmlsbD0idXJsKCNzdmdfNikiIHN0cm9rZS1saW5lam9pbj0ibnVsbCIgc3Ryb2tlLWxpbmVjYXA9Im51bGwiIGQ9Im0wLjU2MjEyLDEwLjYzNDUyYzAsLTUuNTY0OSA0LjQ1NjcxLC0xMC4wNzI0NiA5Ljk1ODgzLC0xMC4wNzI0NmM1LjUwMjEsMCA5Ljk1ODgzLDQuNTA3NTcgOS45NTg4MywxMC4wNzI0NmMwLDIuNzgyNDUgLTEuMTE0MTgsNS4zMDA1NyAtMi45MTYxMiw3LjEyMzA3Yy0wLjkwMDk3LDAuOTExMjUgLTIuOTQwNDEsMi4yNjYxNiAtNC43NDEzNSw0LjcxMjQ1Yy0xLjgwMDkzLDIuNDQ2MjkgLTIuMTkxMDQsNi4wMzY4OCAtMi4yNDU2MSw2LjAzNDUyYy0wLjA1NDU2LC0wLjAwMjM2IC0wLjk4NTc3LC0zLjc3MjU2IC0yLjU5NzMzLC02LjE5MzM3Yy0xLjYxMTU5LC0yLjQyMDgxIC0zLjYwMDE0LC0zLjY0MjM1IC00LjUwMTExLC00LjU1MzZjLTEuODAxOTUsLTEuODIyNSAtMi45MTYxMiwtNC4zNDA2MiAtMi45MTYxMiwtNy4xMjMwN2wwLDBsLTAuMDAwMDIsMHoiIGlkPSJzdmdfMiIvPjwvZz48cmVjdCBpZD0ic3ZnXzkiIGhlaWdodD0iOCIgd2lkdGg9IjgiIHk9IjYuNSIgeD0iNi40OSIgc3Ryb2tlLW9wYWNpdHk9Im51bGwiIHN0cm9rZS13aWR0aD0ibnVsbCIgc3Ryb2tlPSIjODQyMzBhIiBmaWxsPSIjZmZmZmZmIi8+PC9nPjwvc3ZnPg\x3d\x3d",
contentType:"image/svg+xml"},unlocatedStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IHI9IjAuNSIgY3k9IjAuMzU1NDciIGN4PSIwLjMzMjAzIiBzcHJlYWRNZXRob2Q9InBhZCIgaWQ9InN2Z18xMCI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLW9wYWNpdHk9IjAuOTkyMTkiIHN0b3AtY29sb3I9IiNlMmUyZTIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iMC45ODQzOCIgc3RvcC1jb2xvcj0iIzllOWU5ZSIvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxnPjxnIHN0cm9rZT0ibnVsbCIgaWQ9InN2Z18xIj48cGF0aCBzdHJva2U9IiM2NjY2NjYiIHN0cm9rZS1vcGFjaXR5PSIwLjciIGZpbGw9InVybCgjc3ZnXzEwKSIgc3Ryb2tlLWxpbmVqb2luPSJudWxsIiBzdHJva2UtbGluZWNhcD0ibnVsbCIgZD0ibTAuNTYyMTIsMTAuNjM0NTJjMCwtNS41NjQ5IDQuNDU2NzEsLTEwLjA3MjQ2IDkuOTU4ODMsLTEwLjA3MjQ2YzUuNTAyMSwwIDkuOTU4ODMsNC41MDc1NyA5Ljk1ODgzLDEwLjA3MjQ2YzAsMi43ODI0NSAtMS4xMTQxOCw1LjMwMDU3IC0yLjkxNjEyLDcuMTIzMDdjLTAuOTAwOTcsMC45MTEyNSAtMi45NDA0MSwyLjI2NjE2IC00Ljc0MTM1LDQuNzEyNDVjLTEuODAwOTMsMi40NDYyOSAtMi4xOTEwNCw2LjAzNjg4IC0yLjI0NTYxLDYuMDM0NTJjLTAuMDU0NTYsLTAuMDAyMzYgLTAuOTg1NzcsLTMuNzcyNTYgLTIuNTk3MzMsLTYuMTkzMzdjLTEuNjExNTksLTIuNDIwODEgLTMuNjAwMTQsLTMuNjQyMzUgLTQuNTAxMTEsLTQuNTUzNmMtMS44MDE5NSwtMS44MjI1IC0yLjkxNjEyLC00LjM0MDYyIC0yLjkxNjEyLC03LjEyMzA3bDAsMGwtMC4wMDAwMiwweiIgaWQ9InN2Z18yIi8+PC9nPjxyZWN0IHRyYW5zZm9ybT0icm90YXRlKC00NSAxMC41LDEwLjUpICIgc3Ryb2tlPSIjZTJlMmUyIiBpZD0ic3ZnXzExIiBoZWlnaHQ9IjEwIiB3aWR0aD0iMiIgeT0iNS42IiB4PSI5LjUiIHN0cm9rZS13aWR0aD0iMCIgZmlsbD0iIzY2NjY2NiIvPjxyZWN0IHRyYW5zZm9ybT0icm90YXRlKDQ1IDEwLjUsMTAuNSkgIiBzdHJva2U9IiNlMmUyZTIiIGlkPSJzdmdfMTIiIGhlaWdodD0iMTAiIHdpZHRoPSIyIiB5PSI1LjYiIHg9IjkuNSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjNjY2NjY2Ii8+PC9nPjwvc3ZnPg\x3d\x3d",
contentType:"image/svg+xml"},waypointSymbol:{color:[255,255,255,255],size:10,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}},directionSymbol:{color:[0,122,194,255],width:6,type:"esriSLS",style:"esriSLSSolid"},directionEventSymbol:{color:[100,255,100,255],size:8,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,69,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"}},routeSymbol:{color:[20,89,127,255],
width:8,type:"esriSLS",style:"esriSLSSolid"},_geometryService:null,_jsonStringFieldSize:1048576,constructor:function(c){c&&(this.portal=new J.Portal(c))},getFolders:function(){return this.portal?this.portal.signIn().then(k.hitch(this,function(){return this.portal.getPortalUser().getFolders()},!1)).then(k.hitch(this,function(c){var a=this.portal.getPortalUser();c=c||[];c.splice(0,0,{created:a.created,portal:this.portal,title:a.username+" ("+m.networkAnalysis.sharing.rootFolder+")",url:a.userContentUrl});
return c})):[]},canCreateItem:function(){var c=new h;this.portal?this.portal.signIn().then(k.hitch(this,function(){c.resolve(-1<(this.portal.getPortalUser().privileges||[]).indexOf("portal:user:createItem"))}),c.reject):c.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time."));return c.promise},toMinutes:function(c,a,b){c=c||0;switch(a){case "esriNAUSeconds":c/=Math.pow(60,b?-1:1);break;case "esriNAUHours":c*=Math.pow(60,b?-1:1);break;case "esriNAUDays":c*=
Math.pow(1440,b?-1:1)}return c},fromMinutes:function(c,a){return this.toMinutes(c,a,!0)},toMeters:function(c,a,b){c=c||0;switch((a||"").replace("esriNAU","esri")){case "esriInches":c*=Math.pow(0.0254,b?-1:1);break;case "esriFeet":c*=Math.pow(0.3048,b?-1:1);break;case "esriYards":c*=Math.pow(0.9144,b?-1:1);break;case "esriMiles":c*=Math.pow(1609.34,b?-1:1);break;case "esriNauticalMiles":c*=Math.pow(1851.995396854,b?-1:1);break;case "esriMillimeters":c/=Math.pow(1E3,b?-1:1);break;case "esriCentimeters":c/=
Math.pow(100,b?-1:1);break;case "esriKilometers":c*=Math.pow(1E3,b?-1:1);break;case "esriDecimeters":c/=Math.pow(10,b?-1:1)}return c},fromMeters:function(c,a){return this.toMeters(c,a,!0)},toGeolocalTime:function(c,a){return void 0===c||null===c?void 0:c+6E4*(a||0)},toUTCTime:function(c,a){-22091616E5===c&&(c=void 0);return null!==a&&void 0!==a?c-6E4*a:c},getUTCOffset:function(c,a){return null!==a&&void 0!==a&&0<a?(c-a)/60/1E3:void 0},getAttributeUnits:function(c,a){for(var b=a.networkDataset.networkAttributes,
g,e=0;e<b.length;e++)if(b[e].name===c&&"esriNAUTCost"===b[e].usageType){g=b[e].units;break}return g},load:function(c,a){var b=new h,g=k.hitch(this,this.fromMeters),e=k.hitch(this,this.fromMinutes);this.portal?this.portal.signIn().then(k.hitch(this,function(){var f=this.portal.getPortalUser(),d=f.userContentUrl.replace(/\/users\/.+\/?$/,"/items/");v({url:d+c,content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,function(s){v({url:d+c+"/data",content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,
function(c){var d=function(a){for(var d=0;d<c.layers.length;d++)if(c.layers[d].layerDefinition.name===a)return c.layers[d]},n=d("Directions").featureSet.features,r=d("DirectionEvents").featureSet.features,p=d("Stops").featureSet.features,A=d("RouteInfo").featureSet.features[0],t=A.attributes,y=A.geometry.spatialReference,z=u.parse(t.AnalysisSettings),h=z.travelMode.timeAttributeName,q=z.travelMode.distanceAttributeName,x=this.getAttributeUnits(h,a),B=this.getAttributeUnits(q,a),v=a.directionsLengthUnits,
A=t.Messages,w=[],d={directions:{routeId:1,routeName:t.RouteName,summary:{totalLength:this.fromMeters(t.TotalMeters,v),totalTime:this.fromMinutes(t.TotalMinutes,x),totalDriveTime:this.fromMinutes(t.TotalMinutes-t.TotalWaitMinutes,x),envelope:d("RouteInfo").layerDefinition.extent},spatialReference:y,geometryType:"esriGeometryPolyline",features:k.hitch(this,function(){for(var a=[],c=function(a){var c=a,b=n[c].geometry;a=function(a){for(;!b&&(0>a&&0<c||0<a&&c<n.length-1);){c+=a;var d=n[c].geometry;if(d&&
d.paths&&d.paths[0]){b={paths:[[d.paths[0][0<a?0:d.paths[0].length-1],d.paths[0][0<a?0:d.paths[0].length-1]]],spatialReference:y};break}}return b};return a(1)||a(-1)},d=k.hitch(this,function(a){for(var c=[],b=0;b<r.length;b++)r[b].attributes.DirectionSequence===a&&(c.push({ETA:this.toGeolocalTime(r[b].attributes.ArrivalTime,r[b].attributes.UTCOffset),arriveTimeUTC:null===r[b].attributes.UTCOffset?void 0:r[b].attributes.ArrivalTime,strings:u.parse(r[b].attributes.EventMessages)||[],point:{x:r[b].geometry.x,
y:r[b].geometry.y}}),r[b].attributes.EventText&&c[c.length-1].strings.splice(0,0,{string:r[b].attributes.EventText,stringType:"esriDSTGeneral"}));return c}),b=0;b<n.length;b++){var e={attributes:{length:this.fromMeters(n[b].attributes.Meters,v),time:this.fromMinutes(n[b].attributes.Minutes,x),text:n[b].attributes.DirectionText,ETA:this.toGeolocalTime(n[b].attributes.ArrivalTime,n[b].attributes.UTCOffset),arriveTimeUTC:null===n[b].attributes.UTCOffset?void 0:n[b].attributes.ArrivalTime,maneuverType:n[b].attributes.ManeuverType,
_stopSequence:n[b].attributes.StopSequence},geometry:c(b)||p[0]&&p[0].geometry&&{paths:[[[p[0].geometry.x,p[0].geometry.y]]],spatialReference:y},strings:u.parse(n[b].attributes.ManeuverMessages||"[]"),events:d(b)};0===e.strings.length&&delete e.strings;a.push(e)}return a})()},stops:k.hitch(this,function(){for(var a=[],c=0;c<p.length;c++){var b=p[c].attributes,d={geometry:p[c].geometry,attributes:{ObjectID:b.__OBJECTID,Name:b.Name,RouteName:null,Sequence:b.Sequence,TimeWindowStart:b.TimeWindowStart,
TimeWindowEnd:b.TimeWindowEnd,ArriveCurbApproach:b.ArrivalCurbApproach,DepartCurbApproach:b.DepartureCurbApproach,CurbApproach:b.CurbApproach,Status:b.Status,ArriveTime:this.toGeolocalTime(b.ArrivalTime,b.ArrivalUTCOffset),DepartTime:this.toGeolocalTime(b.DepartureTime,b.DepartureUTCOffset),ArriveTimeUTC:b.ArrivalTime,DepartTimeUTC:b.DepartureTime,isWaypoint:1===b.LocationType}},e=d.attributes;e["Attr_"+h]=this.fromMinutes(b.ServiceMinutes,x);e["Attr_"+q]=this.fromMeters(b.ServiceMeters,B);k.mixin(e,
u.parse(b.ServiceOtherCosts||"{}"));e["Cumul_"+h]=this.fromMinutes(b.CumulativeMinutes,x);e["Cumul_"+q]=this.fromMeters(b.CumulativeMeters,B);k.mixin(e,u.parse(b.CumulativeOtherCosts||"{}"));a.push(d)}return a})(),routeName:t.RouteName,spatialReference:y},C=!1,z=k.mixin({returnStops:!0,returnDirections:!0,returnRoutes:!1,ignoreInvalidLocations:!0,outputLines:"esriNAOutputLineTrueShape",directionsOutputType:"complete",directionsLengthUnits:v,doNotLocateOnRestrictedElements:!0,outSpatialReference:new F(y),
stops:new M(function(){for(var a=[],c=0;c<p.length;c++){var b=p[c].attributes,d={geometry:p[c].geometry,attributes:{CurbApproach:b.CurbApproach,Name:b.Name,Sequence:b.Sequence,isWaypoint:1===b.LocationType,TimeWindowStart:b.TimeWindowStart,TimeWindowEnd:b.TimeWindowEnd}};d.attributes["Attr_"+h]=e(b.ServiceMinutes,x);d.attributes["Attr_"+q]=g(b.ServiceMeters,B);k.mixin(d.attributes,u.parse(b.ServiceOtherCosts));a.push(d);C=C||0<b.TimeWindowStart}return{spatialReference:y,geometryType:"esriGeometryPoint",
features:a}}())},z);z.useTimeWindows=C;(!x||!B)&&w.push({message:m.networkAnalysis.sharing.costAttributeMissing,messageType:"Warning"});"1.0"!==t.Version&&w.push({message:m.networkAnalysis.sharing.differentVersion,messageType:"Warning"});b.resolve({routeParameters:k.mixin(new K,z),solveResult:{barriers:[],polygonBarriers:[],polylineBarriers:[],messages:u.parse(A||"[]"),routeResults:[new L(d)]},loadMessages:w,isItemOwner:f.username===s.owner,title:s.title,ownerFolder:s.ownerFolder})}),b.reject)}),
b.reject)}),b.reject):b.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time."));return b.promise},store:function(c,a){var b=new h;c?!c.directions||!c.directions||!c.directions.length?b.reject(Error("Directions are required.")):!c.stops||!c.stops.length?b.reject(Error("Stops are required.")):c.extent?c.routeInfo?c.folder?c.name?this.portal?this.portal.signIn().then(k.hitch(this,function(){var g=this._getRouteId();this._addOrUpdateItem(this._populateLayerInfo(g,
c),c,g,a).then(b.resolve,b.reject)}),b.reject):b.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time.")):b.reject(Error("Layer name is required.")):b.reject(Error("Folder Url is required.")):b.reject(Error("RouteInfo are required.")):b.reject(Error("Extent is required.")):b.reject(Error("Missing required parameters."));return b.promise},createFeatureCollection:function(c){var a=new h;if(c)if(!c.directions||!c.directions||!c.directions.length)a.reject(Error("Directions are required."));
else if(!c.stops||!c.stops.length)a.reject(Error("Stops are required."));else if(c.extent)if(c.routeInfo)if(c.name){var b=this._getRouteId();a.resolve({title:c.name,layerInfo:this._populateLayerInfo(b,c)})}else a.reject(Error("Layer name is required."));else a.reject(Error("RouteInfo are required."));else a.reject(Error("Extent is required."));else a.reject(Error("Missing required parameters."));return a.promise},_addOrUpdateItem:function(c,a,b,g){return k.hitch(this,function(){var b=new h;!this._geometryService&&
(this.portal&&this.portal.helperServices.geometry)&&(this._geometryService=new N(this.portal.helperServices.geometry.url));if(this._geometryService&&a.extent){var c=new O;c.outSR=new F(4326);c.geometries=[a.extent];this._geometryService.project(c).then(k.hitch(this,function(a){var c;a&&a[0]&&(c=a[0].xmin+","+a[0].ymin+","+a[0].xmax+","+a[0].ymax);b.resolve(c)}),b.resolve)}else b.resolve();return b.promise})().then(k.hitch(this,function(b){return v({url:g?a.folder+"/items/"+g+"/update":a.folder+"/addItem",
content:{text:u.stringify(c),extent:b,title:a.name,type:"Feature Collection",typeKeywords:"Data, Feature Collection, Multilayer, Route Layer",description:m.networkAnalysis.sharing.itemSnippet+" "+a.name+k.hitch(this,function(){for(var a=function(a){for(var b=0;b<c.layers.length;b++)if(c.layers[b].layerDefinition.name===a)return c.layers[b].featureSet.features;return[]},b=a("Directions"),e=a("Stops"),g=a("RouteInfo")[0].attributes,a=function(a){if(void 0!==a)for(var b=0;b<e.length;b++)if(e[b].attributes.Sequence===
a)return e[b].attributes;return{}},l="english"===this.portal.getPortalUser().units?"esriMiles":"esriMeters",n=function(a){return H.format(a,{places:2,locale:"root"})},r=k.hitch(this,function(a){return n(this.fromMeters(a,l))+" "+("esriMiles"===l?m.networkAnalysis.sharing.Miles:m.networkAnalysis.sharing.Meters)}),g="\x3cbr\x3e\x3cbr\x3e\x3cb\x3e"+m.networkAnalysis.sharing.routeInfoLayer+"\x3c/b\x3e\x3cul\x3e\x3cli\x3e"+n(g.TotalMinutes)+" "+m.networkAnalysis.sharing.Minutes+"\x3c/li\x3e\x3cli\x3e"+
r(g.TotalMeters)+"\x3c/li\x3e"+(void 0!==g.StartTime?"\x3cli\x3e"+m.networkAnalysis.sharing.StartTime+" "+(new Date(g.StartTime)).toString()+"\x3c/li\x3e":"")+"\x3c/ul\x3e\x3cb\x3e"+m.networkAnalysis.sharing.directionsLayer+"\x3c/b\x3e\x3col\x3e",p=0;p<b.length;p++)var h=a(b[p].attributes.StopSequence),g=g+('\x3cli\x3e\x3cimg style\x3d"display:inline-block;margin:-3px 15px;" src\x3d"js/jsapi/esri/dijit/images/Directions/maneuvers/'+(null===h.ArrivalCurbApproach&&null!==h.DepartureCurbApproach?"esriDMTStopOrigin":
null!==h.ArrivalCurbApproach&&null===h.DepartureCurbApproach?"esriDMTStopDestination":b[p].attributes.ManeuverType)+'.png"\x3e\x3cspan\x3e'+b[p].attributes.DirectionText+"\x3c/span\x3e\x3cbr\x3e\x3cspan\x3e"+n(b[p].attributes.Minutes)+" "+m.networkAnalysis.sharing.Minutes+"\x26nbsp;\x26middot;\x26nbsp;"+r(b[p].attributes.Meters)+"\x3c/span\x3e\x3c/li\x3e");return g+"\x3c/li\x3e"})(),tags:m.networkAnalysis.sharing.itemTags,snippet:m.networkAnalysis.sharing.itemSnippet+" "+a.name,thumbnailUrl:a.thumbnail,
licenseInfo:m.widgets.directions.printDisclaimer,f:"json"},callbackParamName:"callback"},{usePost:!0})}))},_getRouteId:function(){for(var c="",a=0;32>a;a++)c+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[Math.floor(62*Math.random())];return c},_populateLayerInfo:function(c,a){var b={visibility:!0,layers:[],visibleLayers:[0,3],opacity:1};this._addRouteInfoToLayerInfo(b,c,a.routeInfo,a.extent);this._addDirectionsToLayerInfo(b,c,a.directions,a.extent);this._addDirectionEventsToLayerInfo(b,
c,a.directionEvents,a.extent);this._addStopsToLayerInfo(b,c,a.stops,a.extent);return b},_addStopsToLayerInfo:function(c,a,b,g){a=m.networkAnalysis;var e={type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]},f=this._generateFeatureCollectionTemplate("Stops",
a.sharing.stopsLayer,"esriGeometryPoint"),d=f.layerDefinition.fields,s=0<b[0].attributes.ArrivalTime;d.push(this._createField("CurbApproach",a.fields.stops.CurbApproach,"integer",!1,e));d.push(this._createField("ArrivalCurbApproach",a.fields.stops.ArrivalCurbApproach,"integer",!0,e));d.push(this._createField("DepartureCurbApproach",a.fields.stops.DepartureCurbApproach,"integer",!0,e));d.push(this._createField("Name",a.fields.stops.Name,"string",!0));d.push(this._createField("Sequence",a.fields.stops.Sequence,
"integer",!0));d.push(this._createField("Status",a.fields.stops.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,
code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,code:6}]}));d.push(this._createField("LocationType",a.fields.stops.LocationType,"integer",!0,{type:"codedValue",name:"esriNALocationType",codedValues:[{name:a.enums.esriNALocationType.stop,code:0},{name:a.enums.esriNALocationType.waypoint,code:1}]}));d.push(this._createField("TimeWindowStart",a.fields.stops.TimeWindowStart,"date",!1));d.push(this._createField("TimeWindowEnd",
a.fields.stops.TimeWindowEnd,"date",!1));d.push(this._createField("ServiceMinutes",a.fields.stops.ServiceMinutes,"double",!1));d.push(this._createField("ServiceMeters",a.fields.stops.ServiceMeters,"double",!1));d.push(this._createField("ServiceOtherCosts",a.fields.stops.ServiceOtherCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("CumulativeMinutes",a.fields.stops.CumulativeMinutes,"double",!0));d.push(this._createField("CumulativeMeters",a.fields.stops.CumulativeMeters,
"double",!0));d.push(this._createField("CumulativeOtherCosts",a.fields.stops.CumulativeOtherCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("LateMinutes",a.fields.stops.LateMinutes,"double",!1));d.push(this._createField("WaitMinutes",a.fields.stops.WaitMinutes,"double",!1));d.push(this._createField("ArrivalTime",a.fields.stops.ArrivalTime,"date",s));d.push(this._createField("DepartureTime",a.fields.stops.DepartureTime,"date",s));d.push(this._createField("ArrivalUTCOffset",
a.fields.stops.ArrivalUTCOffset,"integer",s));d.push(this._createField("DepartureUTCOffset",a.fields.stops.DepartureUTCOffset,"integer",s));for(e=d=0;e<b.length;e++){var h=b[e],l=h.geometry;f.featureSet.features.push({geometry:l.toJson?l.toJson():l,attributes:k.mixin(h.attributes,{__OBJECTID:d++})})}f.layerDefinition.extent=g.toJson?g.toJson():g;g=new I(2>=b.length?new q(this.firstStopSymbol):new q(this.interimStopSymbol),"Sequence");for(e=0;e<b.length;e++)d=b[e].attributes,h=null,l=a.enums.esriNALocationType.stop,
1===d.LocationType?(h=new D(this.waypointSymbol),l=a.enums.esriNALocationType.waypoint):null===d.ArrivalCurbApproach&&null===d.DepartureCurbApproach?(h=new q(this.unlocatedStopSymbol),l=a.enums.esriNALocationType.stop+" : "+a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached):null===d.ArrivalCurbApproach&&null!==d.DepartureCurbApproach?h=new q(this.firstStopSymbol):null!==d.ArrivalCurbApproach&&null===d.DepartureCurbApproach&&(h=new q(this.lastStopSymbol)),h&&g.addValue({value:d.Sequence,symbol:h,
label:l});f.layerDefinition.drawingInfo.renderer=g.toJson();f.popupInfo={title:"{Name}",fieldInfos:[{fieldName:"Name",label:a.fields.stops.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"Sequence",label:a.fields.stops.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalTime",label:a.fields.stops.ArrivalTime,isEditable:!0,tooltip:"",visible:s,format:{dateFormat:"shortDateShortTime24"},
stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalUTCOffset",label:a.fields.stops.ArrivalUTCOffset,isEditable:!1,tooltip:"",visible:s,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureTime",label:a.fields.stops.DepartureTime,isEditable:!0,tooltip:"",visible:s,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureUTCOffset",label:a.fields.stops.DepartureUTCOffset,
isEditable:!1,tooltip:"",visible:s,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CurbApproach",label:a.fields.stops.CurbApproach,isEditable:!0,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ArrivalCurbApproach",label:a.fields.stops.ArrivalCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureCurbApproach",
label:a.fields.stops.DepartureCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Status",label:a.fields.stops.Status,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"LocationType",label:a.fields.stops.LocationType,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"TimeWindowStart",label:a.fields.stops.TimeWindowStart,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"TimeWindowEnd",label:a.fields.stops.TimeWindowEnd,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceMinutes",label:a.fields.stops.ServiceMinutes,isEditable:!0,tooltip:"",visible:!1,format:{places:2,
digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceMeters",label:a.fields.stops.ServiceMeters,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceOtherCosts",label:a.fields.stops.ServiceOtherCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"CumulativeMinutes",label:a.fields.stops.CumulativeMinutes,isEditable:!1,tooltip:"",
visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CumulativeMeters",label:a.fields.stops.CumulativeMeters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CumulativeOtherCosts",label:a.fields.stops.CumulativeOtherCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"LateMinutes",label:a.fields.stops.LateMinutes,
isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"WaitMinutes",label:a.fields.stops.WaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(f)},_addDirectionsToLayerInfo:function(c,a,b,g){a=m.networkAnalysis;var e=a.enums.esriDirectionsManeuverType,f=this._generateFeatureCollectionTemplate("Directions",
a.sharing.directionsLayer,"esriGeometryPolyline"),d=f.layerDefinition.fields,h=b[0]&&b[0].attributes&&0<b[0].attributes.ArrivalTime;d.push(this._createField("Sequence",a.fields.directions.Sequence,"integer"));d.push(this._createField("StopSequence",a.fields.directions.StopSequence,"integer"));d.push(this._createField("ArrivalTime",a.fields.directions.ArrivalTime,"date",h));d.push(this._createField("UTCOffset",a.fields.directions.UTCOffset,"integer",h));d.push(this._createField("ManeuverType",a.fields.directions.ManeuverType,
"string",!0,{type:"codedValue",name:"esriDirectionsManeuverType",codedValues:[{name:e.esriDMTBearLeft,code:"esriDMTBearLeft"},{name:e.esriDMTBearRight,code:"esriDMTBearRight"},{name:e.esriDMTDepart,code:"esriDMTDepart"},{name:e.esriDMTDoorPassage,code:"esriDMTDoorPassage"},{name:e.esriDMTElevator,code:"esriDMTElevator"},{name:e.esriDMTEndOfFerry,code:"esriDMTEndOfFerry"},{name:e.esriDMTEscalator,code:"esriDMTEscalator"},{name:e.esriDMTFerry,code:"esriDMTFerry"},{name:e.esriDMTForkCenter,code:"esriDMTForkCenter"},
{name:e.esriDMTForkLeft,code:"esriDMTForkLeft"},{name:e.esriDMTForkRight,code:"esriDMTForkRight"},{name:e.esriDMTHighwayChange,code:"esriDMTHighwayChange"},{name:e.esriDMTHighwayExit,code:"esriDMTHighwayExit"},{name:e.esriDMTHighwayMerge,code:"esriDMTHighwayMerge"},{name:e.esriDMTPedestrianRamp,code:"esriDMTPedestrianRamp"},{name:e.esriDMTRampLeft,code:"esriDMTRampLeft"},{name:e.esriDMTRampRight,code:"esriDMTRampRight"},{name:e.esriDMTRoundabout,code:"esriDMTRoundabout"},{name:e.esriDMTSharpLeft,
code:"esriDMTSharpLeft"},{name:e.esriDMTSharpRight,code:"esriDMTSharpRight"},{name:e.esriDMTStairs,code:"esriDMTStairs"},{name:e.esriDMTStop,code:"esriDMTStop"},{name:e.esriDMTStraight,code:"esriDMTStraight"},{name:e.esriDMTTripItem,code:"esriDMTTripItem"},{name:e.esriDMTTurnLeft,code:"esriDMTTurnLeft"},{name:e.esriDMTTurnLeftLeft,code:"esriDMTTurnLeftLeft"},{name:e.esriDMTTurnLeftRight,code:"esriDMTTurnLeftRight"},{name:e.esriDMTTurnRight,code:"esriDMTTurnRight"},{name:e.esriDMTTurnRightLeft,code:"esriDMTTurnRightLeft"},
{name:e.esriDMTTurnRightRight,code:"esriDMTTurnRightRight"},{name:e.esriDMTUnknown,code:"esriDMTUnknown"},{name:e.esriDMTUTurn,code:"esriDMTUTurn"}]}));d.push(this._createField("Meters",a.fields.directions.Meters,"double",!0));d.push(this._createField("Minutes",a.fields.directions.Minutes,"double",!0));d.push(this._createField("DirectionText",a.fields.directions.DirectionText,"string",!0,null,2048));d.push(this._createField("ManeuverMessages",a.fields.directions.ManeuverMessages,"string",!1,null,
this._jsonStringFieldSize));for(d=e=0;d<b.length;d++){var q=b[d],l=q.geometry;f.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:k.mixin(q.attributes,{__OBJECTID:e++})})}f.layerDefinition.extent=g.toJson?g.toJson():g;b=new w(new E(this.directionSymbol));f.layerDefinition.drawingInfo.renderer=b.toJson();f.popupInfo={title:"{Text}",fieldInfos:[{fieldName:"ManeuverType",label:a.fields.directions.ManeuverType,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"DirectionText",label:a.fields.directions.DirectionText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Sequence",label:a.fields.directions.Sequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StopSequence",label:a.fields.directions.StopSequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"ArrivalTime",label:a.fields.directions.ArrivalTime,isEditable:!0,tooltip:"",visible:h,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"UTCOffset",label:a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:h,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Meters",label:a.fields.directions.Meters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",
isEditableOnLayer:!1},{fieldName:"Minutes",label:a.fields.directions.Minutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ManeuverMessages",label:a.fields.directions.ManeuverMessages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(f)},_addDirectionEventsToLayerInfo:function(c,a,b,g){a=m.networkAnalysis;var e=
this._generateFeatureCollectionTemplate("DirectionEvents",a.sharing.directionEventsLayer,"esriGeometryPoint"),f=e.layerDefinition.fields,d=b[0]&&b[0].attributes&&0<b[0].attributes.ArrivalTime;f.push(this._createField("ArrivalTime",a.fields.directionEvents.ArrivalTime,"date",d));f.push(this._createField("UTCOffset",a.fields.directionEvents.UTCOffset,"integer",d));f.push(this._createField("DirectionSequence",a.fields.directionEvents.DirectionSequence,"integer"));f.push(this._createField("Sequence",
a.fields.directionEvents.Sequence,"integer"));f.push(this._createField("EventText",a.fields.directionEvents.EventText,"string",!0,null,2048));f.push(this._createField("EventMessages",a.fields.directionEvents.EventMessages,"string",!1,null,this._jsonStringFieldSize));for(var h=f=0;h<b.length;h++){var q=b[h],l=q.geometry;e.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:k.mixin(q.attributes,{__OBJECTID:f++})})}e.layerDefinition.extent=g.toJson?g.toJson():g;b=new w(new D(this.directionEventSymbol));
e.layerDefinition.drawingInfo.renderer=b.toJson();e.popupInfo={title:a.sharing.directionEventsLayer,fieldInfos:[{fieldName:"EventText",label:a.fields.directionEvents.EventText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalTime",label:a.fields.directionEvents.ArrivalTime,isEditable:!0,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"UTCOffset",label:a.fields.directionEvents.UTCOffset,
isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DirectionSequence",label:a.fields.directionEvents.DirectionSequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Sequence",label:a.fields.directionEvents.Sequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"EventMessages",label:a.fields.directionEvents.EventMessages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(e)},_addRouteInfoToLayerInfo:function(c,a,b,g){a=m.networkAnalysis;var e=this._generateFeatureCollectionTemplate("RouteInfo",a.sharing.routeInfoLayer,"esriGeometryPolyline"),f=e.layerDefinition.fields,d=void 0!==b.attributes.StartTime&&null!==b.attributes.StartTime;f.push(this._createField("Version",
a.fields.routeInfo.Version,"string"));f.push(this._createField("RouteName",a.fields.routeInfo.RouteName,"string",!0,null,1024));f.push(this._createField("TotalMinutes",a.fields.routeInfo.TotalMinutes,"double",!0));f.push(this._createField("TotalMeters",a.fields.routeInfo.TotalMeters,"double",!0));f.push(this._createField("TotalLateMinutes",a.fields.routeInfo.TotalLateMinutes,"double"));f.push(this._createField("TotalWaitMinutes",a.fields.routeInfo.TotalWaitMinutes,"double"));f.push(this._createField("OtherCosts",
a.fields.routeInfo.OtherCosts,"string",!1,null,this._jsonStringFieldSize));f.push(this._createField("StartTime",a.fields.routeInfo.StartTime,"date",d));f.push(this._createField("StartUTCOffset",a.fields.routeInfo.StartUTCOffset,"integer",d));f.push(this._createField("EndTime",a.fields.routeInfo.EndTime,"date",d));f.push(this._createField("EndUTCOffset",a.fields.routeInfo.EndUTCOffset,"integer",d));f.push(this._createField("Messages",a.fields.routeInfo.Messages,"string",!1,null,this._jsonStringFieldSize));
f.push(this._createField("AnalysisSettings",a.fields.routeInfo.AnalysisSettings,"string",!1,null,this._jsonStringFieldSize));f=b.geometry;e.featureSet.features.push({geometry:f&&f.toJson?f.toJson():f,attributes:k.mixin(b.attributes,{__OBJECTID:0,Version:"1.0"})});e.layerDefinition.extent=g.toJson?g.toJson():g;b=new w(new E(this.routeSymbol));e.layerDefinition.drawingInfo.renderer=b.toJson();e.popupInfo={title:a.sharing.routeInfoLayer,fieldInfos:[{fieldName:"Version",label:a.fields.routeInfo.Version,
isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"RouteName",label:a.fields.routeInfo.RouteName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalMinutes",label:a.fields.routeInfo.TotalMinutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalMeters",label:a.fields.routeInfo.TotalMeters,isEditable:!1,tooltip:"",
visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalLateMinutes",label:a.fields.routeInfo.TotalLateMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalWaitMinutes",label:a.fields.routeInfo.TotalWaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"OtherCosts",
label:a.fields.routeInfo.OtherCosts,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StartTime",label:a.fields.routeInfo.StartTime,isEditable:!1,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StartUTCOffset",label:a.fields.routeInfo.StartUTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"EndTime",
label:a.fields.routeInfo.EndTime,isEditable:!1,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"EndUTCOffset",label:a.fields.routeInfo.EndUTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Messages",label:a.fields.routeInfo.Messages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"SolverSettings",
label:a.fields.routeInfo.SolverSettings,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(e)},_generateFeatureCollectionTemplate:function(c,a,b){return{layerDefinition:{name:c,title:a,geometryType:b,objectIdField:"__OBJECTID",type:"Feature Layer",typeIdField:"",drawingInfo:{fixedSymbols:!0},fields:[{name:"__OBJECTID",alias:"OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1,domain:null}],types:[],
capabilities:"Query,Update"},featureSet:{features:[],geometryType:b}}},_createField:function(c,a,b,g,e,f){return"integer"===b?{name:c,alias:a,type:"esriFieldTypeInteger",editable:!0,nullable:!0,visible:!!g,domain:e}:"double"===b?{name:c,alias:a,type:"esriFieldTypeDouble",editable:!0,nullable:!0,visible:!!g,domain:e}:"date"===b?{name:c,alias:a,type:"esriFieldTypeDate",length:36,editable:!0,nullable:!0,visible:!!g,domain:e}:{name:c,alias:a,type:"esriFieldTypeString",length:f||255,editable:!0,nullable:!0,
visible:!!g,domain:e}}})});